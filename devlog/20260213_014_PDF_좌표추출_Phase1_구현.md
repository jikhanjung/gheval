# 014: PDF 좌표 추출 Phase 1 구현

**Date**: 2026-02-13
**Plan**: P05 (Phase 1 only)

## What Changed

Implemented Phase 1 (MVP) of PDF fossil site coordinate extraction: PyMuPDF text extraction, regex-based coordinate scanning (including Korean DMS), review/import dialog, and batch processing.

## Modified Files

| File | Change |
|------|--------|
| `requirements.txt` | Added `PyMuPDF>=1.24.0` |
| `GhCommons.py` | Added `_parse_korean_dms()`, `scan_coordinates_in_text()` (6 regex patterns), `_deduplicate_coords()`, Korean DMS support as fallback in `_parse_single_coord()` |
| `GhPdfExtractor.py` | **New** — Data classes (`ExtractedSite`, `PdfResult`, `BatchResult`), `extract_text_from_pdf()`, `process_single_pdf()`, `PdfProcessorWorker` QThread, `collect_pdf_paths()` |
| `GhDialogs.py` | Added `PdfImportDialog` with file selection, progress bar, results table, import functionality |
| `GhEval.py` | Added `action_import_pdf` (Ctrl+I), File menu item, `_import_from_pdf()` handler |

## Key Decisions

- Korean DMS parsing added as fallback at end of `_parse_single_coord()` to not disrupt existing coordinate parsing
- 6 regex patterns ordered most-specific to least-specific to avoid false positives
- Plain decimal pattern requires 2+ decimal places to reduce false positives
- Cross-page deduplication uses 4-decimal-place rounding (~11m tolerance)
- `scan_coordinates_in_text()` deduplication uses 0.001° tolerance (~111m)
- PdfProcessorWorker catches exceptions per-file — one bad PDF never aborts the batch
- Scanned pages detected but not processed (Phase 2: OCR)

## Coordinate Formats Supported

1. Korean DMS with direction: `북위 37도 33분 59초, 동경 126도 58분 41초`
2. Korean DMS without direction: `37도 33분 59.4초, 126도 58분 41초`
3. DMS with NSEW: `37°33'59"N 126°58'41"E`
4. DDM with NSEW: `37°33.990'N 126°58.680'E`
5. Decimal with direction: `37.5665N, 126.978E`
6. Plain decimal: `37.5665, 126.9780`

## Not Implemented (Future Phases)

- Phase 2: OCR for scanned PDFs (pytesseract)
- Phase 3: NER place name extraction + geocoding (spaCy)
- Phase 4: PDF map image extraction + overlay
