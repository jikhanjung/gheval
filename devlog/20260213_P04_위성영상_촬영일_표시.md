# P04: 위성영상 촬영일 표시 (Imagery Capture Date Overlay)

**날짜**: 2026-02-13

## Context

SKYVIEW (Summer) 선택 시에도 영상이 실제 여름 촬영인지 확인할 수 없다. Esri World Imagery metadata 서비스(Layer 4)를 통해 특정 위치의 촬영일/제공자 정보를 조회할 수 있으며, Wayback 버전별 metadata 서비스도 별도 URL(`metadataLayerUrl`)로 제공된다. 모든 satellite 모드에서 현재 보고 있는 영상의 실제 촬영일을 맵 위에 표시한다.

## 접근 방식

- 맵 위에 Leaflet Control로 촬영일 정보 표시
- JS fetch()로 직접 Esri 메타데이터 서비스 조회 (CORS 지원 확인됨)
- `moveend` 이벤트에 500ms 디바운스 적용
- SKYVIEW/HYBRID: 현재 영상 메타데이터 서비스 (Layer 4) 조회
- SKYVIEW_SUMMER: Wayback 버전별 메타데이터 서비스 조회 (config의 `metadataLayerUrl`)
- ROADMAP: 오버레이 숨김

## 변경 파일

| 파일 | 변경 |
|------|------|
| `GhCommons.py` | `_find_latest_summer()`에서 `metadataLayerUrl` 추가 반환 (3-tuple) |
| `GhMapBridge.py` | `set_wayback_version` signal을 `str`(JSON)으로 변경 |
| `GhComponents.py` | `MapWidget.set_wayback_version()` 파라미터 확장 |
| `GhEval.py` | 3-tuple 처리 |
| `templates/map_view.html` | CSS, Leaflet Control, metadata fetch 함수, moveend 핸들러 |

## 구현 순서

1. `GhCommons.py` — metadataLayerUrl 반환
2. `GhMapBridge.py` — signal 타입 변경
3. `GhComponents.py` — 인터페이스 업데이트
4. `GhEval.py` — 3-tuple 처리
5. `templates/map_view.html` — 촬영일 오버레이 전체
